-- Untitled Roblox GUI Library â€“ Rayfield-Style (funktioniert ohne _G!)

local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local BoldItalic = Font.new("rbxasset://fonts/families/SourceSansPro.json", Enum.FontWeight.Bold, Enum.FontStyle.Italic)

local Library = {}
local Tabs = {}
local CurrentTab = nil

-- GUI erstellen
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "UntitledGUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = game:GetService("CoreGui")

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 430, 0, 400)
MainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
MainFrame.Visible = false
MainFrame.ZIndex = 10
MainFrame.Parent = ScreenGui
Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 14)

local UIScale = Instance.new("UIScale", MainFrame)
UIScale.Scale = 0

-- Title
local TitleLabel = Instance.new("TextLabel", MainFrame)
TitleLabel.Size = UDim2.new(1, -60, 0, 45)
TitleLabel.Position = UDim2.new(0.03, 0, 0, 0)
TitleLabel.BackgroundTransparency = 1
TitleLabel.Text = "Untitled GUI"
TitleLabel.FontFace = BoldItalic
TitleLabel.TextSize = 25
TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
TitleLabel.TextColor3 = Color3.new(1, 1, 1)
TitleLabel.ZIndex = 15

local TitleLine = Instance.new("Frame", MainFrame)
TitleLine.Size = UDim2.new(0.94, 0, 0, 1)
TitleLine.Position = UDim2.new(0.03, 0, 0, 45)
TitleLine.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
TitleLine.ZIndex = 15

-- Close Button
local CloseButton = Instance.new("TextButton", MainFrame)
CloseButton.Size = UDim2.new(0, 36, 0, 36)
CloseButton.Position = UDim2.new(1, -46, 0, 6)
CloseButton.BackgroundColor3 = Color3.fromRGB(170, 35, 40)
CloseButton.Text = ""
CloseButton.ZIndex = 20
Instance.new("UICorner", CloseButton).CornerRadius = UDim.new(1, 0)
CloseButton.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
end)

-- Drag
local DragBar = Instance.new("Frame", MainFrame)
DragBar.Size = UDim2.new(1, 0, 0, 45)
DragBar.BackgroundTransparency = 1
DragBar.ZIndex = 100

local Dragging = false
local DragStart, StartPos

DragBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        Dragging = true
        DragStart = UserInputService:GetMouseLocation()
        StartPos = MainFrame.Position
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if Dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = UserInputService:GetMouseLocation() - DragStart
        MainFrame.Position = UDim2.new(StartPos.X.Scale, StartPos.X.Offset + delta.X, StartPos.Y.Scale, StartPos.Y.Offset + delta.Y)
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then Dragging = false end
end)

-- Content Scrolling (unsichtbare Bar)
local ContentScroll = Instance.new("ScrollingFrame", MainFrame)
ContentScroll.Size = UDim2.new(0, 300, 0, 330)
ContentScroll.Position = UDim2.new(0.30, 0, 0.15, 0)
ContentScroll.BackgroundTransparency = 1
ContentScroll.ScrollBarThickness = 0
ContentScroll.AutomaticCanvasSize = Enum.AutomaticSize.Y
ContentScroll.ZIndex = 12

local ContentFrame = Instance.new("Frame", ContentScroll)
ContentFrame.Size = UDim2.new(1, 0, 1, 0)
ContentFrame.BackgroundTransparency = 1

-- Tabs Frame
local TabsFrame = Instance.new("Frame", MainFrame)
TabsFrame.Size = UDim2.new(0, 115, 0, 330)
TabsFrame.Position = UDim2.new(0.03, 0, 0.15, 0)
TabsFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
TabsFrame.ZIndex = 12
Instance.new("UICorner", TabsFrame).CornerRadius = UDim.new(0, 10)

local TabsStroke = Instance.new("UIStroke", TabsFrame)
TabsStroke.Color = Color3.fromRGB(255, 255, 255)
TabsStroke.Thickness = 1
TabsStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

-- Selector
local Selector = Instance.new("Frame", TabsFrame)
Selector.Size = UDim2.new(1, -16, 0, 40)
Selector.BackgroundTransparency = 1
Selector.ZIndex = 15
Instance.new("UICorner", Selector).CornerRadius = UDim.new(0, 10)

local SelectorStroke = Instance.new("UIStroke", Selector)
SelectorStroke.Color = Color3.fromRGB(255, 255, 255)
SelectorStroke.Thickness = 1
SelectorStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

-- Library Functions
function Library:CreateTab(options)
    local tabName = options.Name or "Tab"
    local tabIndex = #Tabs + 1

    local tabBtn = Instance.new("TextButton", TabsFrame)
    tabBtn.Size = UDim2.new(1, -16, 0, 40)
    tabBtn.Position = UDim2.new(0, 8, 0, 4 + (tabIndex - 1) * 47)
    tabBtn.BackgroundTransparency = 1
    tabBtn.Text = tabName
    tabBtn.FontFace = BoldItalic
    tabBtn.TextSize = 25
    tabBtn.TextColor3 = Color3.new(1, 1, 1)
    tabBtn.ZIndex = 14
    Instance.new("UICorner", tabBtn).CornerRadius = UDim.new(0, 10)

    local tabElements = {}

    tabBtn.MouseButton1Click:Connect(function()
        if CurrentTab == tabName then return end
        CurrentTab = tabName
        TweenService:Create(Selector, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
            Position = tabBtn.Position,
            Size = tabBtn.Size
        }):Play()
        for _, elem in pairs(ContentFrame:GetChildren()) do
            if elem:IsA("GuiObject") then elem.Visible = false end
        end
        for _, elem in pairs(tabElements) do
            elem.Visible = true
        end
    end)

    Tabs[tabName] = tabElements

    if tabIndex == 1 then
        CurrentTab = tabName
        Selector.Position = tabBtn.Position
        Selector.Size = tabBtn.Size
    end

    local tabObj = {}

    function tabObj:CreateToggle(options)
        local name = options.Name or "Toggle"
        local default = options.CurrentValue or false
        local callback = options.Callback or function() end

        local toggleBtn = Instance.new("TextButton", ContentFrame)
        toggleBtn.Size = UDim2.new(0.95, 0, 0, 35)
        toggleBtn.Position = UDim2.new(0.025, 0, 0, 4 + (#tabElements * 47))
        toggleBtn.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
        toggleBtn.Text = name
        toggleBtn.FontFace = BoldItalic
        toggleBtn.TextSize = 22
        toggleBtn.TextColor3 = Color3.new(1, 1, 1)
        toggleBtn.Visible = (CurrentTab == tabName)
        toggleBtn.ZIndex = 14
        Instance.new("UICorner", toggleBtn).CornerRadius = UDim.new(0, 10)

        local stroke = Instance.new("UIStroke", toggleBtn)
        stroke.Color = Color3.fromRGB(255, 255, 255)
        stroke.Thickness = 1
        stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

        local indicator = Instance.new("Frame", toggleBtn)
        indicator.Size = UDim2.new(0, 20, 0, 20)
        indicator.Position = UDim2.new(1, -25, 0.5, -10)
        indicator.BackgroundColor3 = default and Color3.fromRGB(255, 255, 255) or Color3.fromRGB(40, 40, 40)
        indicator.ZIndex = 15
        Instance.new("UICorner", indicator).CornerRadius = UDim.new(1, 0)

        local value = default
        toggleBtn.MouseButton1Click:Connect(function()
            value = not value
            TweenService:Create(indicator, TweenInfo.new(0.2), {
                BackgroundColor3 = value and Color3.fromRGB(255, 255, 255) or Color3.fromRGB(40, 40, 40)
            }):Play()
            callback(value)
        end)

        table.insert(tabElements, toggleBtn)
    end

    return tabObj
end

-- Global machen
CreateTab = Library.CreateTab

-- Insert Open/Close
UserInputService.InputBegan:Connect(function(input, gpe)
    if gpe then return end
    if input.KeyCode == Enum.KeyCode.Insert then
        if MainFrame.Visible then
            TweenService:Create(UIScale, TweenInfo.new(0.2, Enum.EasingStyle.Back, Enum.EasingDirection.In), {Scale = 0}):Play()
            task.delay(0.2, function() MainFrame.Visible = false end)
        else
            MainFrame.Visible = true
            UIScale.Scale = 0
            TweenService:Create(UIScale, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {Scale = 1}):Play()
        end
    end
end)

print("Untitled GUI Library loaded! Use CreateTab({Name = \"TabName\"}) to add tabs and toggles.")
