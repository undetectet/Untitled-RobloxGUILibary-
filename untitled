-- Roblox Main Menu Base – Mit Tabs & Toggles aus Config

local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local BoldItalic = Font.new("rbxasset://fonts/families/SourceSansPro.json", Enum.FontWeight.Bold, Enum.FontStyle.Italic)

-- Config lesen
local Name = _G.MenuName or "My Menu"
local Tabs = _G.MenuTabs or {"Combat"}
local Toggles = _G.MenuToggles or {Combat = {"Aimbot"}}

-- GUI
local gui = Instance.new("ScreenGui")
gui.Name = Name
gui.ResetOnSpawn = false
gui.Parent = game:GetService("CoreGui")

local main = Instance.new("Frame")
main.Size = UDim2.new(0, 430, 0, 400)
main.Position = UDim2.new(0.5, 0, 0.5, 0)
main.AnchorPoint = Vector2.new(0.5, 0.5)
main.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
main.Visible = false
main.ZIndex = 10
main.Parent = gui
Instance.new("UICorner", main).CornerRadius = UDim.new(0, 14)

local uiScale = Instance.new("UIScale", main)
uiScale.Scale = 0

-- Title
local title = Instance.new("TextLabel", main)
title.Size = UDim2.new(1, -60, 0, 45)
title.Position = UDim2.new(0.03, 0, 0, 0)
title.BackgroundTransparency = 1
title.Text = Name
title.FontFace = BoldItalic
title.TextSize = 25
title.TextXAlignment = Enum.TextXAlignment.Left
title.TextColor3 = Color3.new(1, 1, 1)
title.ZIndex = 15

local titleLine = Instance.new("Frame", main)
titleLine.Size = UDim2.new(0.94, 0, 0, 1)
titleLine.Position = UDim2.new(0.03, 0, 0, 45)
titleLine.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
titleLine.ZIndex = 15

-- Close
local closeBtn = Instance.new("TextButton", main)
closeBtn.Size = UDim2.new(0, 36, 0, 36)
closeBtn.Position = UDim2.new(1, -46, 0, 6)
closeBtn.BackgroundColor3 = Color3.fromRGB(170, 35, 40)
closeBtn.Text = ""
closeBtn.AutoButtonColor = false
closeBtn.ZIndex = 20
Instance.new("UICorner", closeBtn).CornerRadius = UDim.new(1, 0)
closeBtn.MouseButton1Click:Connect(function() gui:Destroy() end)

-- Drag
local dragBar = Instance.new("Frame", main)
dragBar.Size = UDim2.new(1, 0, 0, 45)
dragBar.BackgroundTransparency = 1
dragBar.ZIndex = 100

local dragging = false
local dragStart, startPos

dragBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = UserInputService:GetMouseLocation()
        startPos = main.Position
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = UserInputService:GetMouseLocation() - dragStart
        main.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end
end)

-- Content Scrolling
local contentScroll = Instance.new("ScrollingFrame", main)
contentScroll.Size = UDim2.new(0, 300, 0, 330)
contentScroll.Position = UDim2.new(0.30, 0, 0.15, 0)
contentScroll.BackgroundTransparency = 1
contentScroll.ScrollBarThickness = 6
contentScroll.AutomaticCanvasSize = Enum.AutomaticSize.Y
contentScroll.ZIndex = 12

local content = Instance.new("Frame", contentScroll)
content.Size = UDim2.new(1, 0, 1, 0)
content.BackgroundTransparency = 1

-- Tabs Frame
local tabsFrame = Instance.new("Frame", main)
tabsFrame.Size = UDim2.new(0, 115, 0, 330)
tabsFrame.Position = UDim2.new(0.03, 0, 0.15, 0)
tabsFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
tabsFrame.ZIndex = 12
Instance.new("UICorner", tabsFrame).CornerRadius = UDim.new(0, 10)

local tabsStroke = Instance.new("UIStroke", tabsFrame)
tabsStroke.Color = Color3.fromRGB(255, 255, 255)
tabsStroke.Thickness = 1
tabsStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

-- Selector
local selector = Instance.new("Frame", tabsFrame)
selector.Size = UDim2.new(1, -16, 0, 40)
selector.BackgroundTransparency = 1
selector.ZIndex = 15
Instance.new("UICorner", selector).CornerRadius = UDim.new(0, 10)

local selectorStroke = Instance.new("UIStroke", selector)
selectorStroke.Color = Color3.fromRGB(255, 255, 255)
selectorStroke.Thickness = 1
selectorStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

-- Tab & Toggle System
local tabButtons = {}
local tabContents = {}
local currentTab = nil

local function selectTab(tabName)
    if currentTab == tabName then return end
    currentTab = tabName
    TweenService:Create(selector, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
        Position = tabButtons[tabName].Position,
        Size = tabButtons[tabName].Size
    }):Play()
    for _, obj in pairs(content:GetChildren()) do
        if obj:IsA("GuiObject") then obj.Visible = false end
    end
    for _, obj in pairs(tabContents[tabName] or {}) do
        obj.Visible = true
    end
end

local function createTab(name, index)
    local btn = Instance.new("TextButton", tabsFrame)
    btn.Size = UDim2.new(1, -16, 0, 40)
    btn.Position = UDim2.new(0, 8, 0, 4 + (index - 1) * 47)
    btn.BackgroundTransparency = 1
    btn.Text = name
    btn.FontFace = BoldItalic
    btn.TextSize = 25
    btn.TextColor3 = Color3.new(1, 1, 1)
    btn.AutoButtonColor = false
    btn.ZIndex = 14
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 10)
    btn.MouseButton1Click:Connect(function()
        selectTab(name)
    end)
    tabButtons[name] = btn
    tabContents[name] = {}
end

local function createToggle(tabName, toggleName, index)
    local btn = Instance.new("TextButton", content)
    btn.Size = UDim2.new(0.95, 0, 0, 35)
    btn.Position = UDim2.new(0.025, 0, 0, 4 + (index - 1) * 47)
    btn.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    btn.Text = toggleName
    btn.FontFace = BoldItalic
    btn.TextSize = 22
    btn.TextColor3 = Color3.new(1, 1, 1)
    btn.AutoButtonColor = false
    btn.Visible = false
    btn.ZIndex = 14
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 10)

    local stroke = Instance.new("UIStroke", btn)
    stroke.Color = Color3.fromRGB(255, 255, 255)
    stroke.Thickness = 1
    stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

    local indicator = Instance.new("Frame", btn)
    indicator.Name = "Indicator"
    indicator.Size = UDim2.new(0, 20, 0, 20)
    indicator.Position = UDim2.new(1, -25, 0.5, -10)
    indicator.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    indicator.ZIndex = 15
    Instance.new("UICorner", indicator).CornerRadius = UDim.new(1, 0)

    -- Toggle Funktion (hier später echte Features einbauen)
    local enabled = false
    btn.MouseButton1Click:Connect(function()
        enabled = not enabled
        TweenService:Create(indicator, TweenInfo.new(0.2), {
            BackgroundColor3 = enabled and Color3.fromRGB(255, 255, 255) or Color3.fromRGB(40, 40, 40)
        }):Play()
        print(toggleName .. " = " .. tostring(enabled))
    end)

    table.insert(tabContents[tabName], btn)
end

-- Tabs & Toggles aus Config erstellen
for i, tabName in ipairs(Tabs) do
    createTab(tabName, i)
end

for tabName, toggleList in pairs(Toggles) do
    for i, toggleName in ipairs(toggleList) do
        createToggle(tabName, toggleName, i)
    end
end

if #Tabs > 0 then
    selectTab(Tabs[1])
end

-- Insert Open/Close
UserInputService.InputBegan:Connect(function(input, gpe)
    if gpe then return end
    if input.KeyCode == Enum.KeyCode.Insert then
        if main.Visible then
            TweenService:Create(uiScale, TweenInfo.new(0.2, Enum.EasingStyle.Back, Enum.EasingDirection.In), {Scale = 0}):Play()
            task.delay(0.2, function() main.Visible = false end)
        else
            main.Visible = true
            uiScale.Scale = 0
            TweenService:Create(uiScale, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {Scale = 1}):Play()
        end
    end
end)

print(Name .. " loaded! Tabs: " .. table.concat(Tabs, ", "))
