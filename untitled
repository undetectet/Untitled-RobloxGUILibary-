-- Untitled Roblox GUI Library – Rayfield-Style (Tabs & Toggles)

local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local BoldItalic = Font.new("rbxasset://fonts/families/SourceSansPro.json", Enum.FontWeight.Bold, Enum.FontStyle.Italic)

local Name = "Untitled GUI"

-- GUI
local gui = Instance.new("ScreenGui")
gui.Name = Name
gui.ResetOnSpawn = false
gui.Parent = game:GetService("CoreGui")

local main = Instance.new("Frame")
main.Size = UDim2.new(0, 430, 0, 400)
main.Position = UDim2.new(0.5, 0, 0.5, 0)
main.AnchorPoint = Vector2.new(0.5, 0.5)
main.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
main.Visible = false
main.ZIndex = 10
main.Parent = gui
Instance.new("UICorner", main).CornerRadius = UDim.new(0, 14)

local uiScale = Instance.new("UIScale", main)
uiScale.Scale = 0

-- Title
local title = Instance.new("TextLabel", main)
title.Size = UDim2.new(1, -60, 0, 45)
title.Position = UDim2.new(0.03, 0, 0, 0)
title.BackgroundTransparency = 1
title.Text = Name
title.FontFace = BoldItalic
title.TextSize = 25
title.TextXAlignment = Enum.TextXAlignment.Left
title.TextColor3 = Color3.new(1, 1, 1)
title.ZIndex = 15

local titleLine = Instance.new("Frame", main)
titleLine.Size = UDim2.new(0.94, 0, 0, 1)
titleLine.Position = UDim2.new(0.03, 0, 0, 45)
titleLine.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
titleLine.ZIndex = 15

-- Close
local closeBtn = Instance.new("TextButton", main)
closeBtn.Size = UDim2.new(0, 36, 0, 36)
closeBtn.Position = UDim2.new(1, -46, 0, 6)
closeBtn.BackgroundColor3 = Color3.fromRGB(170, 35, 40)
closeBtn.Text = ""
closeBtn.AutoButtonColor = false
closeBtn.ZIndex = 20
Instance.new("UICorner", closeBtn).CornerRadius = UDim.new(1, 0)
closeBtn.MouseButton1Click:Connect(function() gui:Destroy() end)

-- Drag
local dragBar = Instance.new("Frame", main)
dragBar.Size = UDim2.new(1, 0, 0, 45)
dragBar.BackgroundTransparency = 1
dragBar.ZIndex = 100

local dragging = false
local dragStart, startPos

dragBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = UserInputService:GetMouseLocation()
        startPos = main.Position
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = UserInputService:GetMouseLocation() - dragStart
        main.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end
end)

-- Content Scrolling (unsichtbare Bar, Mausrad funktioniert)
local contentScroll = Instance.new("ScrollingFrame", main)
contentScroll.Size = UDim2.new(0, 300, 0, 330)
contentScroll.Position = UDim2.new(0.30, 0, 0.15, 0)
contentScroll.BackgroundTransparency = 1
contentScroll.ScrollBarThickness = 0
contentScroll.AutomaticCanvasSize = Enum.AutomaticSize.Y
contentScroll.ZIndex = 12

local content = Instance.new("Frame", contentScroll)
content.Size = UDim2.new(1, 0, 1, 0)
content.BackgroundTransparency = 1

-- Tabs
local tabsFrame = Instance.new("Frame", main)
tabsFrame.Size = UDim2.new(0, 115, 0, 330)
tabsFrame.Position = UDim2.new(0.03, 0, 0.15, 0)
tabsFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
tabsFrame.ZIndex = 12
Instance.new("UICorner", tabsFrame).CornerRadius = UDim.new(0, 10)

local tabsStroke = Instance.new("UIStroke", tabsFrame)
tabsStroke.Color = Color3.fromRGB(255, 255, 255)
tabsStroke.Thickness = 1
tabsStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

local selector = Instance.new("Frame", tabsFrame)
selector.Size = UDim2.new(1, -16, 0, 40)
selector.BackgroundTransparency = 1
selector.ZIndex = 15
Instance.new("UICorner", selector).CornerRadius = UDim.new(0, 10)

local selectorStroke = Instance.new("UIStroke", selector)
selectorStroke.Color = Color3.fromRGB(255, 255, 255)
selectorStroke.Thickness = 1
selectorStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

-- Library Functions
local Library = {}

local Tabs = {}
local currentTab = nil

function Library:CreateTab(options)
    local tabName = options.Name or "Tab"
    local tabIndex = #Tabs + 1

    local btn = Instance.new("TextButton", tabsFrame)
    btn.Size = UDim2.new(1, -16, 0, 40)
    btn.Position = UDim2.new(0, 8, 0, 4 + (tabIndex - 1) * 47)
    btn.BackgroundTransparency = 1
    btn.Text = tabName
    btn.FontFace = BoldItalic
    btn.TextSize = 25
    btn.TextColor3 = Color3.new(1, 1, 1)
    btn.ZIndex = 14
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 10)

    local tabContent = {}

    btn.MouseButton1Click:Connect(function()
        if currentTab == tabName then return end
        currentTab = tabName
        TweenService:Create(selector, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
            Position = btn.Position,
            Size = btn.Size
        }):Play()
        for _, obj in pairs(content:GetChildren()) do
            if obj:IsA("GuiObject") then obj.Visible = false end
        end
        for _, obj in pairs(Tabs[tabName] or {}) do
            obj.Visible = true
        end
    end)

    Tabs[tabName] = tabContent

    if tabIndex == 1 then
        currentTab = tabName
        selector.Position = btn.Position
        selector.Size = btn.Size
    end

    -- Tab-Objekt zurückgeben
    local tabObj = {}

    function tabObj:CreateToggle(options)
        local toggleName = options.Name or "Toggle"
        local currentValue = options.CurrentValue or false
        local callback = options.Callback or function() end
        local flag = options.Flag

        local toggleBtn = Instance.new("TextButton", content)
        toggleBtn.Size = UDim2.new(0.95, 0, 0, 35)
        toggleBtn.Position = UDim2.new(0.025, 0, 0, 4 + (#tabContent) * 47)
        toggleBtn.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
        toggleBtn.Text = toggleName
        toggleBtn.FontFace = BoldItalic
        toggleBtn.TextSize = 22
        toggleBtn.TextColor3 = Color3.new(1, 1, 1)
        toggleBtn.Visible = (currentTab == tabName)
        toggleBtn.ZIndex = 14
        Instance.new("UICorner", toggleBtn).CornerRadius = UDim.new(0, 10)

        local stroke = Instance.new("UIStroke", toggleBtn)
        stroke.Color = Color3.fromRGB(255, 255, 255)
        stroke.Thickness = 1
        stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

        local indicator = Instance.new("Frame", toggleBtn)
        indicator.Name = "Indicator"
        indicator.Size = UDim2.new(0, 20, 0, 20)
        indicator.Position = UDim2.new(1, -25, 0.5, -10)
        indicator.BackgroundColor3 = currentValue and Color3.fromRGB(255, 255, 255) or Color3.fromRGB(40, 40, 40)
        indicator.ZIndex = 15
        Instance.new("UICorner", indicator).CornerRadius = UDim.new(1, 0)

        toggleBtn.MouseButton1Click:Connect(function()
            currentValue = not currentValue
            TweenService:Create(indicator, TweenInfo.new(0.2), {
                BackgroundColor3 = currentValue and Color3.fromRGB(255, 255, 255) or Color3.fromRGB(40, 40, 40)
            }):Play()
            callback(currentValue)
        end)

        table.insert(tabContent, toggleBtn)
    end

    return tabObj
end

-- Global Function verfügbar machen
CreateTab = Library.CreateTab

-- Insert Open/Close
UserInputService.InputBegan:Connect(function(input, gpe)
    if gpe then return end
    if input.KeyCode == Enum.KeyCode.Insert then
        if main.Visible then
            TweenService:Create(uiScale, TweenInfo.new(0.2, Enum.EasingStyle.Back, Enum.EasingDirection.In), {Scale = 0}):Play()
            task.delay(0.2, function() main.Visible = false end)
        else
            main.Visible = true
            uiScale.Scale = 0
            TweenService:Create(uiScale, TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {Scale = 1}):Play()
        end
    end
end)

print("Untitled GUI Library loaded! Use CreateTab() to add features.")
